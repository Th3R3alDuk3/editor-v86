
<!doctype html>
<html>
    <head>

        <title>editor-v86-tcc</title>

        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link rel="stylesheet" href="index.css">

    </head>
    <body>

        <script type="text/javascript" src="v86/libv86.js"></script>
        <script type="text/javascript">

            "use strict";
            
            window.onload = () => {

                var emulator = window.emulator = new V86Starter({
                    wasm_path: "v86/v86.wasm",
                    memory_size: 512 * 1024 * 1024,
                    vga_memory_size: 8 * 1024 * 1024,
                    screen_container: document.getElementById("screen_container"),
                    bios: {
                        url: "bios/seabios.bin",
                    },
                    vga_bios: {
                        url: "bios/vgabios.bin",
                    },
                    hda: {
                        url: "9p/archlinux32.img",
                        async: true
                    },
                    filesystem: {
                        baseurl: "9p/archlinux32/",
                        basefs: "9p/fs.json"
                    },
                    autostart: true
                });

                emulator.add_listener("serial0-output-char", (char) => {

                    if(char === "\r") {
                        return;
                    }

                    data += char;
                    console.log(data);

                    if(data.startsWith("[root@archlinux32 ")) {
                        emulator.serial0_send("ls");
                        console.log("ready");
                    }
                });

            }

        </script>

        <div class="flex-container">

            <div class="flex-item1">
                <div id="screen_container">
                    <div style="white-space: pre; font: 14px monospace; line-height: 14px"></div>
                    <canvas style="display: none"></canvas>
                </div>
            </div>

        </div>
        
    </body>
</html>

